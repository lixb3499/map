### 跟踪器

#### 概述

`tracker.py` 文件实现了一个目标跟踪器，结合了目标检测信息和卡尔曼滤波，用于追踪视频中的目标。

#### `Tracker` 类

- `__init__(self, content, frame_rate=6)`: 初始化跟踪器。
  - 接收从视频帧中读取的目标检测信息 `content`，这些信息包括目标的坐标、ID、车牌号等。
  - 为每个检测到的目标创建一个 `Tracks` 对象，并初始化一些参数，如下一个可用的轨迹 ID、最大允许丢失帧数、卡尔曼滤波器等。
  - 轨迹对象 `Tracks` 包含了目标的状态信息（位置、速度等）以及一些辅助标志，如是否确认、是否匹配等。
- `iou_mat(self, content)`: 计算当前轨迹和检测框之间的交并比（IoU）矩阵。
  - 调用 `content2detections` 函数将读入的目标检测信息转换为目标坐标。
  - 遍历每个轨迹和每个检测框，计算其 IoU 并填充矩阵。
- `update1(self, content)`: 更新跟踪器状态。这个函数用于没有yolov8的id（也就是自己分配id的时候）用的更新函数
  - 调用 `iou_mat` 计算 IoU 矩阵。
  - 调用 `iou_match` 函数进行匹配，得到匹配上的轨迹和检测框的索引。
  - 遍历轨迹列表，标记匹配上的轨迹，更新其状态，对于未匹配上的轨迹则判断是否丢失，超过最大丢失帧数则删除。
  - 遍历检测框列表，对于未匹配上的检测框创建新的轨迹。
  - 更新轨迹列表中每条轨迹的状态。
- `update(self, content)`: 类似于 `update1`，但适用于具有已知检测框 ID 的情况。通过检测框的 ID 进行匹配。当使用yolov8的id（即不用自己做跟踪的时候）用的更新函数
  - 调用 `content2detections` 函数将读入的目标检测信息转换为目标坐标。
  - 遍历每个轨迹和每个检测框，判断是否匹配，匹配上则更新轨迹状态，未匹配上则标记为未匹配并更新轨迹状态。
  - 删除丢失的轨迹。
- `draw_tracks(self, img)`: 将跟踪到的目标绘制在图像上。
  - 遍历每个轨迹，调用轨迹对象的 `draw` 函数，在图像上绘制目标边界框。

#### `content2detections` 函数

- `content2detections(content)`: 从文件读取的内容中提取检测到的目标信息。
  - 将读入的文本信息解析为目标坐标、ID、车牌号等信息。
  - 将解析后的信息存储在字典列表中，每个字典包含一个目标的信息。

#### 操作流程

1. **初始化跟踪器**

   - 读取视频帧的目标检测信息。
   - 创建 `Tracker` 对象，初始化每个目标的轨迹。
   - 初始化一些参数，如下一个可用的轨迹 ID（自己分配ID时才会使用，使用YOLOv8的时候不需要）、最大允许丢失帧数、卡尔曼滤波器等。

2. **更新跟踪器状态**

   这里如果使用了YOLOv8的跟踪的ID那就不需要进行IoU匹配的，相应的跟新函数为update否则为updata1

   - 调用 `update` 或 `update1` 函数，根据是否有检测框的 ID 进行匹配。
   - 计算 IoU 矩阵，使用匈牙利算法进行匹配。
   - 更新每个匹配上的轨迹的状态，删除丢失的轨迹。
   - 对于未匹配上的检测框，创建新的轨迹。
   - 最后更新每条轨迹的状态。

3. **绘制跟踪到的目标**

   - 调用 `draw_tracks` 函数，在图像上绘制每个跟踪到的目标的边界框。

以上流程集成了目标检测、目标匹配和轨迹更新等步骤，实现了基于卡尔曼滤波的目标跟踪。